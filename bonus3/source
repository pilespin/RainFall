//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

// ------------------------ Structures ------------------------

struct _IO_FILE 
{
    int 1;
};

// ------------------------ Functions -------------------------

// Address range: 0x80484f4 - 0x804861f
int main(int argc, char ** argv) 
{
    struct _IO_FILE * file = fopen("/home/user/end/.pass", "r"); // 0x8048513
    int data;
    memset((char *)&data, 0, 33);
    if (argc == 2 && file != NULL) 
    {
        // 0x804854d
        fread((char *)&data, 1, 66, file);
        int * str = (int *)((int)argv + 4); // 0x804857f_0
        atoi((char *)*str);
        // BYTE PTR [esp+eax*1+0x18],0x0
        str + atoi  + 23  = 0
        int data2;
        fread((char *)&data2, 1, 65, file);
        fclose(file);

        if (strcmp((char *)&data, (char *)*str) == 0) 
        {
            // 0x80485e3
            execl("/bin/sh", "sh");
            // branch -> 0x8048615
        } 
        else 
        {
            // 0x8048601
            puts((char *)&data2);
            // branch -> 0x8048615
        }
        // 0x8048615
        return 0;
    }
    // 0x8048615
    return -1;
}

// --------------- Dynamically Linked Functions ---------------

// int atoi(const char * nptr);
// int execl(const char * path, const char * arg, ...);
// int fclose(FILE * stream);
// FILE * fopen(const char * restrict filename, const char * restrict modes);
// size_t fread(void * restrict ptr, size_t size, size_t n, FILE * restrict stream);
// int puts(const char * s);
// int strcmp(const char * s1, const char * s2);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (i686-redhat-linux-gcc) (4.6.3)
// Detected functions: 1
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-11-22 12:51:19
